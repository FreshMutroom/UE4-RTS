<!DOCTYPE html>

<style>
   
   .searchBarForm {
       width: 450px;
       padding: 15px;
       margin: 150px auto 50px auto;
       background: #444;
       background: rgba(0,0,0,.2);
       border-radius: 10px;
       box-shadow: 0 1px 1px rgba(0,0,0,.4) inset, 0 1px 0 rgba(255,255,255,.2);
   }
   
   .searchBarForm input:focus {
       outline: 0;
       background: #fff;
       box-shadow: 0 0 2px rgba(0,0,0,.8) inset;
   }
   
</style>

<script>
   
   //------------------------------------------------
   // ------- Trie Implementation -------
   //------------------------------------------------
   // Really wanted this in its own file but I could not
   // get the linking to the other file to work
   
   
   /** 
    *	A single node in a trie
    */
   class TrieNode 
   {
      constructor() 
      {
         // The letter attached to this node. Only the root node should keep this empty
         this.letter = "";
         // Whether this node is the last letter of a word
         this.bIsWord = false;
         // if bIsWord == true then this equals the word
         this.word = "";
         // Child nodes
         this.children = [];
      }
  };
   
   TrieNode.prototype.recursiveFindChildThenAdd = function(str, index)
   {
      for (var i = 0; i < this.children.length; ++i)
      {
         if (this.children[i].letter == str.charAt(index))
         {
            if (index >= str.length)
            {
               console.error("recursiveFindChildThenAdd(): index >= str.length");
            }
            
            index++;
            this.children[i].recursiveFindChildThenAdd(str, index);
            return;
         }
      }

      /* If here then none of the children had the letter. Create a new node with the letter */
      var newNode = new TrieNode();
      newNode.letter = str.charAt(index);
      this.children.push(newNode);
      
      // ------- Begin debugging code -------
      if (typeof TrieNode.prototype.recursiveFindChildThenAdd.newNodeCount == 'undefined')
      {
         TrieNode.prototype.recursiveFindChildThenAdd.newNodeCount = 0;
      }
      TrieNode.prototype.recursiveFindChildThenAdd.newNodeCount++;
      console.log(newNode.letter);
      // ------- End debugging code -------
      
      // Check if at end of string
      if (index + 1 == str.length)
      {
         newNode.bIsWord = true;
         newNode.word = str;
      }
      else	
      {
         index++;
         newNode.recursiveFindChildThenAdd(str, index);
      }
   };

   /** Add a word to the trie. This is intended to be called on the root node */
   TrieNode.prototype.insert = function(str) 
   {
      this.recursiveFindChildThenAdd(str, 0);
   };

   /**
    * Get words in the trie that prefix a string
    *
    * @param str - string to get words for 
    * @param index - current position in str 
    * @param words - array of words that str is a prefix for 
    */
   TrieNode.prototype.recursiveGetPrefixedWords = function(str, index, words)
   {
      index++;
      /* Check if this node is a word and it is the same or greater length than str. If yes then add it */
      if (this.bIsWord == true && str.length <= index)
      {
         words.push(this.word);
      }
   
      if (str.length <= index)
      {
         for (var i = 0; i < this.children.length; ++i)
         {
             this.children[i].recursiveGetPrefixedWords(str, index, words);
         }
      }
      else
      {
         for (var i = 0; i < this.children.length; ++i)
         {
            if (this.children[i].letter.toLowerCase() == str.charAt(index).toLowerCase())
            {
               this.children[i].recursiveGetPrefixedWords(str, index, words);
               /* Have commented this return. Reason is the search is case insensitive so if user types "a" 
               then the entry "apple" and "Apple" are both possibilities so cannot return since one might 
               get skipped */
               //return;
            }
         }
      }
   };
   
   
   /** Class declaration: a trie. Contains a hashset and a root node */
   class Trie
   {
      constructor()
      {
         // Should I be using new here? Or is there a better way?

         // A container that holds all the words in the trie
         this.wordsSet = new Set();
         // The root node of the trie
         this.RootNode = new TrieNode();
      }
   };


   /** 
    * Check whether a string has already been added to the trie
    *
    *	@return - true if the string has already been added to the trie.
    */
   Trie.prototype.contains = function(str)
   {
      return this.wordsSet.has(str);
   };

   /**
    * Try add a string to the trie 
    *   
    * @param str - the string to add to the trie 
    */
   Trie.prototype.insert = function(str)
   {
      if (str.length == 0)
      {
         // Avoid adding empty string
         return;
      }
   
      if (this.contains(str))
      {
         // Avoid adding string if it's already in the trie
         return;
      }
      
      this.RootNode.insert(str);
      this.wordsSet.add(str);
   };

   /** 
    * Return all the words in the trie that have str as a prefix 
    *   
    * @param str - prefix string
    * @return - array of words that have str as a prefix 
    */
   Trie.prototype.getPrefixedWords = function(str)
   {
      var words = [];

      if (str.length == 0)
      {
         return words;
      }

      this.RootNode.recursiveGetPrefixedWords(str, -1, words);
      
      return words;
   };
   
   // End trie implementation
   //------------------------------------------------------
   
   function hideSearchBoxDropdownMenu()
   {
      var ul =  document.getElementById("searchBoxDropdownList");
      var li = ul.getElementsByTagName("li");
      
       for (var i = 0; i < li.length; ++i)
      {
         li[i].style.display = "none";
      }
   }
   
   function onSearchBoxTextChanged()
   {
      var input = document.getElementById("searchBoxInput");
      var enteredText = input.value;
      var ul =  document.getElementById("searchBoxDropdownList");
      var li = ul.getElementsByTagName("li");
      // This function should be implemented in Documentation/SearchBoxImpl.js. I might need to 'link' to the file 
      // or something (similar to C++ #include)
      var prefixedWords = window.TestTrie.getPrefixedWords(enteredText); 
      
      for (var i = 0; i < li.length; ++i)
      {
         if (prefixedWords.length > i)
         {
            // Show the list item 
            li[i].style.display = "";
            // Set it's text
            li[i].textContent = prefixedWords[i];
         }
         else
         {
            // Hide the list item
            li[i].style.display = "none";
         }
      }
   }
   
   
   // Root node of trie for testing only
   var TestTrie = new Trie();
   TestTrie.insert("apple");
   TestTrie.insert("apples");
   TestTrie.insert("Apple");
   TestTrie.insert("bat");
   TestTrie.insert("battle");
   
</script>

<html>
  <body>
    <h1>Documentation</h1>
      
    <!-- Search box. 
Note: only onkeyup is bound to onSearchBoxTextChanged() which isn't good enough cause copy and paste is a thing -->
     <form class="searchBarForm">
        <input type="text" onkeyup="onSearchBoxTextChanged()" id="searchBoxInput" placeholder="Search...">
        <button type="submit">Search</button>
     </form>
     <!-- Dropdown list that predicts what you could be searching for -->
     <ul id="searchBoxDropdownList">
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
        <li style.display="none"><a href="#"></a></li>
     </ul>
     
    <p>
      Documentation is auto generated
    </p>
    
  </body>
</html>


