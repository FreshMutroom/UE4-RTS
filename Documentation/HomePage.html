<!DOCTYPE html>

<style>
   
</style>

<html>
  <body>
    <h1>Documentation</h1>
      
    <!-- Search box. 
Note: only onkeyup is bound to onSearchBoxTextChanged() which isn't good enough cause copy and paste is a thing -->
    <input type="text" onkeyup="onSearchBoxTextChanged()" id="searchBoxInput" placeholder="Search...">
    
     <!-- Dropdown list that predicts what you could be searching for -->
     <ul id="searchBoxDropdownList">
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
        <li><a href="#"></a></li>
     </ul>
     
    <p>
      Documentation is auto generated
    </p>
    
  </body>
</html>

<script>
   // Root node of trie for testing only
   var TestTrieRoot = new Trie();
   
   function onSearchBoxTextChanged()
   {
      var input = document.getElementById("searchBoxInput");
      var enteredText = input.value;
      var ul =  document.getElementById("searchBoxDropdownList");
      var li = ul.getElementsByTagName("li");
      // This function should be implemented in Documentation/SearchBoxImpl.js. I might need to 'link' to the file 
      // or something (similar to C++ #include)
      var prefixedWords = window.TestTrieRoot.RootNode.getPrefixedWords(enteredText); 
      
      for (var i = 0; i < li.length; ++i)
      {
         if (prefixedWords.length > i)
         {
            // Show the list item 
            li[i].style.display = "";
            // Set it's text
            li[i].textContent = prefixedWords[i];
         }
         else
         {
            // Hide the list item
            li[i].style.display = "none";
         }
      }
   }
   
   
   //------------------------------------------------
   // ------- Trie Implementation -------
   //------------------------------------------------
   // Really wanted this in its own file but I could not
   // get the linking to the other file to work
   
   /* Class declaration: a trie. Contains a hashset and a root node */
   function Trie()
   {
      // Should I be using new here? Or is there a better way?

      // A container that holds all the words in the trie
      this.wordsSet = new Set();
      // The root node of the trie
      this.RootNode = new TrieNode();
   };


   /** 
    *	@return - true if the string has already been added to the trie.
    */
   Trie.prototype.contains = function(str)
   {
      return wordsSet.has(str);
   };

   Trie.prototype.insert = function(str)
   {
      var bSuccess = RootNode.insert(str);
      if (bSuccess)
      {
         wordsSet.add(str);
      }
   };

   Trie.prototype.getPrefixedWords = function(str)
   {
      return RootNode.getPrefixedWords(str);
   };


   /** 
    *	Class declaration 
    */
   function TrieNode()
   {
       this.letter = '\0';
       this.bIsWord = false;
       this.children = [];
   };

   TrieNode.prototype.recursiveFindChildThenAdd = function(str, index)
   {
      for (var i = 0; i < this.children.length; ++i)
      {
         if (this.children[i].letter == str[index])
         {
            // assert(index < str.length);
            index++;
            recursiveFindChildThenAdd(str, index);
            return;
         }
      }

      /* If here then none of the children had the letter. Create a new node with the letter */
      var newNode = new TrieNode();
      newNode.letter = str[index];
      this.children.push(newNode);

      // Check if at end of string
      if (index + 1 == str.length)
      {
         newNode.bIsWord = true;
      }
      else	
      {
         index++;
         newNode.recursiveFindChildThenAdd(str, index);
      }
   };

   /* Add a word to the trie. This is intended to be called on the root node */
   TrieNode.prototype.insert = function(str) 
   {
      if (str.length == 0)
      {
         // Avoid adding empty string
         return false;
      }

      if (this.contains(str))
      {
         // Avoid adding string if it's already in the trie
         return false;
      }
   
      this.recursiveFindChildThenAdd(str, 0);
      
      return true;
   };

   /* Hoping here that words is pass by reference
   @param str - string to get words for 
   @param index - current position in str 
   @param words - array of words that str is a prefix for */
   TrieNode.prototype.recursiveGetPrefixedWords = function(str, index, words)
   {
      /* Check if this node is a word. If yes then add it */
      if (this.bIsWord == true)
      {
         words.push(str.substring(0, index + 1));
      }

      index++;
      for (var i = 0; i < this.children.length; ++i)
      {
         if (this.children[i].letter == str[index])
         {
            this.children[i].recursiveGetPrefixedWords(str, index, words);
            return;
         }
      }
   };

   /* This is intended to be called on the root node 
   @param str - the prefix string */
   TrieNode.prototype.getPrefixedWords = function(str)
   {	
      var words = [];

      if (str.length == 0)
      {
         return words;
      }

      this.recursiveGetPrefixedWords(str, 0, words); 

      return words;
   };
   
</script>
